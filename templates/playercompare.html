{% extends 'index.html' %} {% block body_block %}



<div class="container">


    <div class="section">
        <div class="row">

            {% if errors %}
                        {% for i in errors %}
                                <h3>{{ i }}</h3>
                        {% endfor %}

                {% else %}

        </div>  
        <div class="row">
                <h5><center>Consistency Adjusted Avg vs. Match Progress</center></h5>    
            </div>
        <div class="row">
                <div id="caalinechart" style="width: 900px; height: 500px;"></div>
          </div>
          <div class="divider"></div>
          <div class="row">
                <h5><center>Batting Impact Factor vs. Match Progress</center></h5>    
            </div>
        <div class="row">
                <div id="biflinechart" style="width: 900px; height: 500px;"></div>
          </div>

        <div class="divider"></div>
        <div class="row">
            <h5><center>Check out your Player Recommendations to Boost Your Fantasy Points</center></h5>    
        </div>
        <div class="row">
                <div class="col s6">
                  <div class="card red lighten-3">
                    <div class="card-content black-text">
                      <span class="card-title"><center>Player Drop Suggestions</center></span>
                            <table>
                                <thead>
                                  <tr>
                                      <th data-field="player_name">Player Name</th>
                                      <th data-field="CAA">CAA</th>
                                      <th data-field="batting_impact">Batting Impact</th>
                                  </tr>
                                </thead>

                                <tbody>
                                  <tr>
                                    <td>{{recommendations.drop_player1.player_name}}</td>
                                    <td>{{recommendations.drop_player1.caa}}</td>
                                    <td>{{recommendations.drop_player1.last_bat_impact}}</td>
                                  </tr>
                                  <tr>
                                    <td>{{recommendations.drop_player2.player_name}}</td>
                                    <td>{{recommendations.drop_player2.caa}}</td>
                                    <td>{{recommendations.drop_player2.last_bat_impact}}</td>
                                  </tr>
                                  <tr>
                                    <td>{{recommendations.drop_player3.player_name}}</td>
                                    <td>{{recommendations.drop_player3.caa}}</td>
                                    <td>{{recommendations.drop_player3.last_bat_impact}}</td>
                                  </tr>
                                </tbody>
                            </table>
                      <p>{{message}}</p>
                    </div>
                  </div>
                </div>

                <div class="col s6">
                  <div class="card light-green lighten-1">
                    <div class="card-content white-text">
                      <span class="card-title"><center>Player Pick Suggestions</center></span>
                            <table>
                                <thead>
                                  <tr>
                                      <th data-field="player_name">Player Name</th>
                                      <th data-field="CAA">CAA</th>
                                      <th data-field="batting_impact">Batting Impact</th>
                                  </tr>
                                </thead>

                                <tbody>
                                  <tr>
                                    <td>{{recommendations.pick_player1.player_name}}</td>
                                    <td>{{recommendations.pick_player1.caa}}</td>
                                    <td>{{recommendations.pick_player1.last_bat_impact}}</td>
                                  </tr>
                                  <tr>
                                    <td>{{recommendations.pick_player2.player_name}}</td>
                                    <td>{{recommendations.pick_player2.caa}}</td>
                                    <td>{{recommendations.pick_player2.last_bat_impact}}</td>
                                  </tr>
                                  <tr>
                                    <td>{{recommendations.pick_player3.player_name}}</td>
                                    <td>{{recommendations.pick_player3.caa}}</td>
                                    <td>{{recommendations.pick_player3.last_bat_impact}}</td>
                                  </tr>
                                </tbody>
                            </table>
                      <p>{{message}}</p>
                    </div>
                  </div>
                </div>

            </div>
  

        <div class="divider"></div>
        <div class="row">
            <h5><center>Twitter Sentiment Analysis</center></h5>    
        </div>
        <div class="row">
            <h6><center>Positive Sentiment Timeline</center></h6>    
        </div>
        <div class="row">
            <div id="pos_sentiment_div"></div>
        </div>
        <div class="divider"></div>
        <div class="row">
            <h6><center>Neutral Sentiment Timeline</center></h6>    
        </div>
        <div class="row">
            <div id="neutral_sentiment_div"></div>
        </div>
        <div class="divider"></div>
        <div class="row">
            <h6><center>Negative Sentiment Timeline</center></h6>    
        </div>
        <div class="row">
            <div id="neg_sentiment_div" ></div>
        </div>



        <form method="get" action="/playerCompareAction">
            
            <div class="row">
                <h5><center>Need help comparing player performances for your next draft?</center></h5>    
            </div>
            <div class="row">
                <center><h6>Compare Your Current Team Players with the Rest</h5></center>
            </div>
            <div class="row">
                <div class="input-field col s6">
                    <select name="myPlayerSelect">
                        <option value="">Choose First Batsman</option>
                        {%for i in myPlayerList %}
                            {% if message and i.player_name.player_name == myPlayer.player_name.player_name %}
                                 <option value="{{i.player_name.player_name}}" selected>{{i.player_name.player_name}}</option>
                            {% else %}
                                <option value="{{i.player_name.player_name}}">{{i.player_name.player_name}}</option>
                            {% endif %}
                        {% endfor %}
                    </select>
                    <label>Player 1</label>
                </div>

                <div class="input-field col s6">
                    <select name="allPlayerSelect">
                        <option value="">Choose Second Batsman</option>
                        {%for i in allPlayerList %}
                            {% if message and i.player_name == otherPlayer.player_name.player_name %}
                                <option value="{{i.player_name}}" selected>{{i.player_name}}</option>
                            {% else %}
                                <option value="{{i.player_name}}">{{i.player_name}}</option>
                            {% endif %}
                        {% endfor %}
                    </select>
                    <label>Player 2</label>
                </div>
            </div>
            <div class="row">
            <center><input id="search" class="btn btn-medium green" type="submit" value="Submit" /></center>
            </div>
                  
        </form>
        
        {% if otherPlayer %}
            <div class="row">
                <div class="col s6 offset-s3">
                  <div class="card light-green lighten-1">
                    <div class="card-content white-text">
                      <span class="card-title"><center>Comparison Results</center></span>
                            <table>
                                <thead>
                                  <tr>
                                      <th data-field="player_name">Player Name</th>
                                      <th data-field="CAA">CAA</th>
                                      <th data-field="batting_impact">Batting Impact</th>
                                  </tr>
                                </thead>

                                <tbody>
                                  <tr>
                                    <td>{{myPlayer.player_name.player_name}}</td>
                                    <td>{{myPlayer.caa}}</td>
                                    <td>{{myPlayer.last_bat_impact}}</td>
                                  </tr>
                                  <tr>
                                    <td>{{otherPlayer.player_name.player_name}}</td>
                                    <td>{{otherPlayer.caa}}</td>
                                    <td>{{otherPlayer.last_bat_impact}}</td>
                                  </tr>
                                </tbody>
                            </table>
                      <p>{{message}}</p>
                    </div>
                  </div>
                </div>
            </div>

            {% else %}
            <div class="row">
                <div class="col s6 offset-s3">
                  <div class="card light-green lighten-1">
                    <div class="card-content white-text">
                      <span class="card-title"><center>Comparison Results</center></span>
                           
                      <p>{{message}}</p>
                    </div>
                  </div>
                </div>
            </div>


        {% endif %}
      

                {% endif %} <!-- This endif handles closes the else case condition - when no error-->
           
    </div>
</div>

<script type="text/javascript">


var chart = c3.generate({
    bindto: '#caalinechart',
    data: {
        columns: [
            {% for key, value in caa_dict.items %}
              ['{{key}}', {{value}}],
            {% endfor %}
        ]
    }, 
    axis : {
      x: {
        label: 'Match Number',
        min : 0
      }

    }
});

var chart2 = c3.generate({
    bindto: '#biflinechart',
    data: {
        columns: [
            {% for key, value in bif_dict.items %}
              ['{{key}}', {{value}}],
            {% endfor %}
        ]
    }, 
    axis : {
      x: {
        label: 'Match Number',
        min : 0
      }

    }
});

var chartPosSentiment = c3.generate({
    bindto: '#pos_sentiment_div',
    data: {
        
        x: 'x',
//        xFormat: '%Y%m%d', // 'xFormat' can be used as custom format of 'x'
        columns: [
            ['x', '2016-03-18','2016-03-22','2016-03-26','2016-03-30','2016-04-03'],
            {% for key, value in positive_weekly.items %}
              ['{{key}}', {{value}}],
            {% endfor %}
        ]
    },
    axis: {
        x: {
            type: 'timeseries',
            tick: {
                format: '%Y-%m-%d'
            }
        }
    }
});
var chartNegativeSentiment = c3.generate({
    bindto: '#neg_sentiment_div',
    data: {        
        x: 'x',
//        xFormat: '%Y%m%d', // 'xFormat' can be used as custom format of 'x'
        columns: [
            ['x', '2016-03-18','2016-03-22','2016-03-26','2016-03-30','2016-04-03'],
            {% for key, value in negative_weekly.items %}
              ['{{key}}', {{value}}],
            {% endfor %}
        ]
    },
    axis: {
        x: {
            type: 'timeseries',
            tick: {
                format: '%Y-%m-%d'
            }
        }
    }
});

var chartNeutralSentiment = c3.generate({
    bindto: '#neutral_sentiment_div',
    data: {
        
        x: 'x',
//        xFormat: '%Y%m%d', // 'xFormat' can be used as custom format of 'x'
        columns: [
            ['x', '2016-03-18','2016-03-22','2016-03-26','2016-03-30','2016-04-03'],
            {% for key, value in neutral_weekly.items %}
              ['{{key}}', {{value}}],
            {% endfor %}
        ]
    },
    axis: {
        x: {
            type: 'timeseries',
            tick: {
                format: '%Y-%m-%d'
            }
        }
    }
});

</script>
{% endblock %}

