{% extends 'index.html' %} {% block body_block %}

<div class="container">


    <div class="section">
        <div class="row">

            {% if errors %}
                        {% for i in errors %}
                                <h3>{{ i }}</h3>
                        {% endfor %}

                {% else %}

        </div>  
        <form method="get" action="/playerPage"> 
            
            <div class="row">
                <h4 style="color:green"><center>My Player Data</center></h4>    
            </div>
            <div class="row">
                <div class="input-field col s6">
                    <select name="myPlayerSelect">
                        <option value="">Select Batsman</option>
                        {%for i in myPlayerList %}
                            {% if i.player_name.player_name == myPlayer.player_name.player_name %}
                                 <option value="{{i.player_name.player_name}}" selected>{{i.player_name.player_name}}</option>
                            {% else %}
                                <option value="{{i.player_name.player_name}}">{{i.player_name.player_name}}</option>
                            {% endif %}
                        {% endfor %}
                    </select>
                    <label>Player 1</label>
                </div>
                <div class="col s6">
                    <input id="search" class="btn btn-medium green" type="submit" value="Go" />
                </div>
            </div>
                  
        </form>

        

        {% if articles %}
        <div class="divider"></div>
        <div class="row">
            <h4 style="color:green"><center>News Articles</center></h4>    
        </div>

            <div class="row">
                {% for single_article in articles %}
                <div class="col s12">
                  <div class="card green lighten-4">
                    <div class="card-content black-text">
                      <span class="card-title"><center><b>{{single_article.title}}</b></center></span>
                            <table>
                                <tbody>
                                  <tr>
                                    <td>Date</td>
                                    <td>{{single_article.date}}</td>
                                  </tr>
                                  <tr>
                                    <td>Summary</td>
                                    <td>{{single_article.summary}}</td>
                                  </tr>
                                </tbody>
                            </table>
                            <div class="card-action white-text">
                                 <a href="{{single_article.article_url}}" target="_blank" style="color:black" >Read Full Article...</a>
                            </div>
                    </div>
                  </div>
                </div>
                {% endfor %}
            </div>
        {% endif %}


        {% if newsTweets %}

        <div class="divider"></div>
        <div class="row">
            <h4 style="color:#2196f3"><center>News Tweets</center></h4>    
        </div>
        <div class="row">
                {% for single_news_tweet in newsTweets %}
                <div class="col s12">
                  <div class="card light-blue lighten-3">
                    <div class="card-content white-text">
                      <span class="card-title"><center><b>{{single_news_tweet.username}}</b></center></span>
                        <div class="card-content">
                            <p><b>{{single_news_tweet.date}}</b></p>
                            <p><b>{{single_news_tweet.text}}</b></p>
                        </div>
                        <div class="card-action"> 
                                 <a href="{{single_news_tweet.permalink}}" target="_blank" style="color:white"><b>Read Tweet on Twitter...</b></a>
                        </div>
                    </div>
                  </div>
                </div>
                {% endfor %}
            </div>
        {% endif %}



    {% if match_data %}
        <div class="divider"></div>
        <div class="row">
            <h4 style="color:green"><center>Recent Match Stats</center></h4>    
        </div>

                <div class="row">
                
                <div class="col s12">                
                            <table class = "bordered highlight">
                                <thead>
                                    <th>Date</th>
                                    <th>Runs</th>
                                    <th>Fours</th>
                                    <th>Sixes</th>
                                    <th>Strike Rate</th>
                                    <th>Opponent Team</th>
                                    <th>Match Result</th>
                                </thead>
                                <tbody>
                                {% for match_record in match_data %}
                                      <tr>
                                        <td>{{match_record.match_date}}</td>
                                        <td>{{match_record.runs}}</td>
                                        <td>{{match_record.fours}}</td>
                                        <td>{{match_record.six}}</td>
                                        <td>{{match_record.strike_rate}}</td>
                                        <td>{{match_record.opponent_team_name}}</td>
                                        <td>{{match_record.match_status}}</td>
                                      </tr>
                                  {% endfor %}
                                </tbody>
                            </table>
                    </div>
            </div>
            <div class="row">
                <h4 style="color:#2196f3"><center>Player's Sentiment Analysis Timeline</center></h4>    
            </div>
            <div class="row">
                <div id="player_sentiment_chart" style="width: 900px; height: 500px;"></div>
            </div>
        {% endif %}


        {% if playerTweets %}

        <div class="divider"></div>
        <div class="row">
            <h4 style="color:#2196f3"><center>User Tweets</center></h4>    
        </div>
        <div class="row">
                {% for single_tweet in playerTweets %}
                <div class="col s12">
                  <div class="card light-blue lighten-3">
                    <div class="card-content white-text">
                      <span class="card-title"><center><b>{{single_tweet.username}}</b></center></span>
                        <div class="card-content">
                            <p><b>{{single_tweet.date}}</b></p>
                            <p><b>{{single_tweet.text}}</b></p>
                        </div>
                        <div class="card-action"> 
                                 <a href="{{single_tweet.permalink}}" target="_blank" style="color:white"><b>Read Tweet on Twitter...</b></a>
                        </div>
                    </div>
                  </div>
                </div>
                {% endfor %}
            </div>
        {% endif %}
                {% endif %} <!-- This endif handles closes the else case condition - when no error-->
           
    </div>
</div>
<script type="text/javascript">
  var playerSentimentChart = c3.generate({
      bindto: '#player_sentiment_chart',
      data: {
          
          x: 'x',
  //        xFormat: '%Y%m%d', // 'xFormat' can be used as custom format of 'x'
          columns: [
              ['x', '2016-03-18','2016-03-22','2016-03-26','2016-03-30','2016-04-03'],
              {% for key, value in player_sentiment_dict.items %}
                ['{{key}}', {{value}}],
              {% endfor %}
          ]
      },
      axis: {
          x: {
              type: 'timeseries',
              tick: {
                  format: '%Y-%m-%d'
              }
          }
      }
  });
</script>

{% endblock %}
